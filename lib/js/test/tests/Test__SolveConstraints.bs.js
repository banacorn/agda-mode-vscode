// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Curry = require("rescript/lib/js/curry.js");
var Assert = require("assert");
var Test__Util$AgdaModeVscode = require("./Test__Util.bs.js");
var State__Connection$AgdaModeVscode = require("../../src/State/State__Connection.bs.js");

function run(normalization) {
  var fileContent = {
    contents: ""
  };
  beforeEach(async function () {
        fileContent.contents = await Test__Util$AgdaModeVscode.$$File.read(Test__Util$AgdaModeVscode.Path.asset("Issue204.agda"));
      });
  afterEach(async function () {
        return await Test__Util$AgdaModeVscode.$$File.write(Test__Util$AgdaModeVscode.Path.asset("Issue204.agda"), fileContent.contents);
      });
  it("should be responded with the correct responses", (async function () {
          var ctx = await Test__Util$AgdaModeVscode.AgdaMode.makeAndLoad("Issue204.agda");
          var responses = await State__Connection$AgdaModeVscode.sendRequestAndCollectResponses(ctx.state, {
                TAG: "SolveConstraintsGlobal",
                _0: normalization,
                [Symbol.for("name")]: "SolveConstraintsGlobal"
              });
          var filteredResponses = responses.filter(Test__Util$AgdaModeVscode.filteredResponse);
          return Curry._3(Assert.deepEqual, filteredResponses, [
                      {
                        TAG: "InteractionPoints",
                        _0: [
                          0,
                          1
                        ],
                        [Symbol.for("name")]: "InteractionPoints"
                      },
                      {
                        TAG: "SolveAll",
                        _0: [
                          [
                            0,
                            "4"
                          ],
                          [
                            1,
                            "4"
                          ]
                        ],
                        [Symbol.for("name")]: "SolveAll"
                      }
                    ], undefined);
        }));
  it("should solve all goals", (async function () {
          var ctx = await Test__Util$AgdaModeVscode.AgdaMode.makeAndLoad("Issue204.agda");
          await Test__Util$AgdaModeVscode.AgdaMode.solveConstraints(ctx, normalization, undefined);
          Curry._3(Assert.deepEqual, ctx.state.goals.length, 0, undefined);
          var actual = await Test__Util$AgdaModeVscode.$$File.read(Test__Util$AgdaModeVscode.Path.asset("Issue204.agda"));
          var expected = await Test__Util$AgdaModeVscode.$$File.read(Test__Util$AgdaModeVscode.Path.asset("Issue204.agda.out"));
          return Curry._3(Assert.equal, actual, expected, undefined);
        }));
}

describe.only("agda-mode.solve-constraints", (function () {
        describe("Simplified", (function () {
                run("Simplified");
              }));
        describe("Normalised", (function () {
                run("Normalised");
              }));
        describe("Instantiated", (function () {
                run("Instantiated");
              }));
      }));

exports.run = run;
/*  Not a pure module */
