// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Curry = require("rescript/lib/js/curry.js");
var Assert = require("assert");
var Vscode = require("vscode");
var Connection__DevALS$AgdaModeVscode = require("../../../src/Connection/Download/Connection__DevALS.bs.js");
var Connection__Download$AgdaModeVscode = require("../../../src/Connection/Download/Connection__Download.bs.js");

describe("Connection DevALS", (function () {
        this.timeout(10000);
        describe("GitHub API integration", (function () {
                it("should fetch dev release from GitHub API", (async function () {
                        var globalStorageUri = Vscode.Uri.file("/tmp/test-dev-als");
                        var releaseResult = await Connection__DevALS$AgdaModeVscode.getALSReleaseManifestWithoutCache(globalStorageUri);
                        if (releaseResult.TAG === "Ok") {
                          var devRelease = releaseResult._0.find(function (release) {
                                return release.tag_name === "dev";
                              });
                          if (devRelease !== undefined) {
                            return Curry._3(Assert.deepStrictEqual, devRelease.tag_name, "dev", undefined);
                          } else {
                            Assert.fail("Dev release not found");
                            return ;
                          }
                        }
                        Assert.fail("Failed to fetch releases: " + Connection__Download$AgdaModeVscode.$$Error.toString(releaseResult._0));
                      }));
              }));
        describe("getDownloadDescriptor integration", (function () {
                it("should fetch dev release spec from GitHub API", (async function () {
                        var globalStorageUri = Vscode.Uri.file("/tmp/test-dev-als");
                        var result = await Connection__DevALS$AgdaModeVscode.getDownloadDescriptor(globalStorageUri, "Ubuntu");
                        if (result.TAG === "Ok") {
                          var downloadDescriptor = result._0;
                          Curry._3(Assert.deepStrictEqual, downloadDescriptor.release.tag_name, "dev", undefined);
                          Curry._3(Assert.deepStrictEqual, downloadDescriptor.saveAsFileName, "dev-als", undefined);
                          return Curry._3(Assert.deepStrictEqual, downloadDescriptor.asset.name, "als-dev-Agda-2.8.0-ubuntu.zip", undefined);
                        }
                        Assert.fail("Expected success but got error: " + Connection__Download$AgdaModeVscode.$$Error.toString(result._0));
                      }));
              }));
      }));

var GitHub;

exports.GitHub = GitHub;
/*  Not a pure module */
