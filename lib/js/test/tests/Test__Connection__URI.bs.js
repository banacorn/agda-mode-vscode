// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Curry = require("rescript/lib/js/curry.js");
var Assert = require("assert");
var Vscode = require("vscode");
var Nodeos = require("node:os");
var Nodeurl = require("node:url");
var Nodepath = require("node:path");
var OS$AgdaModeVscode = require("../../src/Util/OS.bs.js");
var Connection__URI$AgdaModeVscode = require("../../src/Connection/Shared/Connection__URI.bs.js");

describe("Connection__URI", (function () {
        describe("parse", (function () {
                it("should parse lsp:// URLs as LspURI variant", (function () {
                        var uri = Connection__URI$AgdaModeVscode.parse("lsp://localhost:8080");
                        if (uri.TAG !== "FileURI") {
                          return Curry._3(Assert.deepStrictEqual, uri._0.protocol, "lsp:", undefined);
                        }
                        Assert.fail("Expected LspURI variant");
                      }));
                it("should reject non-lsp URLs and treat as filepath", (function () {
                        var uri = Connection__URI$AgdaModeVscode.parse("http://example.com");
                        if (uri.TAG === "FileURI") {
                          return ;
                        }
                        Assert.fail("Expected FileURI variant for non-lsp URL");
                      }));
                it("should parse absolute file paths as FileURI variant", (function () {
                        var uri = Connection__URI$AgdaModeVscode.parse("/usr/bin/agda");
                        var expected = Vscode.Uri.file(Nodepath.resolve("/usr/bin/agda"));
                        if (uri.TAG === "FileURI") {
                          return Curry._3(Assert.deepStrictEqual, uri._0, expected, undefined);
                        }
                        Assert.fail("Expected FileURI variant");
                      }));
                it("should parse relative file paths as FileURI variant", (function () {
                        var uri = Connection__URI$AgdaModeVscode.parse("usr/bin/agda");
                        var expected = Vscode.Uri.file(Nodepath.resolve("usr/bin/agda"));
                        if (uri.TAG === "FileURI") {
                          return Curry._3(Assert.deepStrictEqual, uri._0, expected, undefined);
                        }
                        Assert.fail("Expected FileURI variant");
                      }));
                it("should expand tilde in file paths", (function () {
                        var uri = Connection__URI$AgdaModeVscode.parse("~/bin/agda");
                        var expected = Vscode.Uri.file(Nodepath.resolve(Nodeos.homedir(), "bin/agda"));
                        if (uri.TAG === "FileURI") {
                          var actual = uri._0;
                          Assert.ok(!actual.fsPath.includes("~"));
                          return Curry._3(Assert.deepStrictEqual, actual.toString(), expected.toString(), undefined);
                        }
                        Assert.fail("Expected FileURI variant");
                      }));
                it("should normalize file paths with ..", (function () {
                        var uri = Connection__URI$AgdaModeVscode.parse("/usr/bin/../bin/agda");
                        var expected = Vscode.Uri.file(Nodepath.resolve("/usr/bin", "..", "bin/agda"));
                        if (uri.TAG === "FileURI") {
                          return Curry._3(Assert.deepStrictEqual, uri._0.toString(), expected.toString(), undefined);
                        }
                        Assert.fail("Expected FileURI variant");
                      }));
                it("should be able to parse file paths", (function () {
                        var actual = Connection__URI$AgdaModeVscode.parse("path/to/als");
                        var expected = OS$AgdaModeVscode.onUnix ? ({
                              TAG: "FileURI",
                              _0: Vscode.Uri.file(Nodepath.resolve("path/to/als"))
                            }) : ({
                              TAG: "FileURI",
                              _0: Vscode.Uri.file(Nodepath.resolve("path\\to\\als"))
                            });
                        Curry._3(Assert.deepStrictEqual, actual, expected, undefined);
                      }));
                it("should be able to parse convert \"/c/path/to/agda\" to \"c:/path/to/agda\" on Windows", (function () {
                        var actual = Connection__URI$AgdaModeVscode.parse("/c/path/to/agda");
                        var expected = OS$AgdaModeVscode.onUnix ? ({
                              TAG: "FileURI",
                              _0: Vscode.Uri.file("/c/path/to/agda")
                            }) : ({
                              TAG: "FileURI",
                              _0: Vscode.Uri.file("c:\\path\\to\\agda")
                            });
                        Curry._3(Assert.deepStrictEqual, actual, expected, undefined);
                        var actual$1 = Connection__URI$AgdaModeVscode.parse("/d/path/to/agda");
                        var expected$1 = OS$AgdaModeVscode.onUnix ? ({
                              TAG: "FileURI",
                              _0: Vscode.Uri.file("/d/path/to/agda")
                            }) : ({
                              TAG: "FileURI",
                              _0: Vscode.Uri.file("d:\\path\\to\\agda")
                            });
                        Curry._3(Assert.deepStrictEqual, actual$1, expected$1, undefined);
                      }));
              }));
        describe("toString", (function () {
                it("should convert payload of FileURI with `VSCode.Uri.toString`", (function () {
                        var uri = Vscode.Uri.file("/usr/bin/../bin/agda");
                        var expected = uri.toString();
                        var actual = Connection__URI$AgdaModeVscode.toString({
                              TAG: "FileURI",
                              _0: uri
                            });
                        Curry._3(Assert.deepStrictEqual, actual, expected, undefined);
                      }));
                it("should convert payload of LspURI with `NodeJs.Url.toString`", (function () {
                        var url = new Nodeurl.URL("lsp://localhost:8080");
                        var expected = url.toString();
                        var actual = Connection__URI$AgdaModeVscode.toString({
                              TAG: "LspURI",
                              _0: url
                            });
                        Curry._3(Assert.deepStrictEqual, actual, expected, undefined);
                      }));
              }));
        describe("equal", (function () {
                it("should return true for equal file paths", (function () {
                        var uri1 = {
                          TAG: "FileURI",
                          _0: Vscode.Uri.file("/usr/bin/agda")
                        };
                        var uri2 = {
                          TAG: "FileURI",
                          _0: Vscode.Uri.file("/usr/bin/agda")
                        };
                        Curry._3(Assert.deepStrictEqual, Connection__URI$AgdaModeVscode.equal(uri1, uri2), true, undefined);
                      }));
                it("should return false for different file paths", (function () {
                        var uri1 = {
                          TAG: "FileURI",
                          _0: Vscode.Uri.file("/usr/bin/agda")
                        };
                        var uri2 = {
                          TAG: "FileURI",
                          _0: Vscode.Uri.file("/usr/local/bin/agda")
                        };
                        Curry._3(Assert.deepStrictEqual, Connection__URI$AgdaModeVscode.equal(uri1, uri2), false, undefined);
                      }));
                it("should return true for equal LSP URIs", (function () {
                        var url1 = new Nodeurl.URL("lsp://localhost:8080");
                        var url2 = new Nodeurl.URL("lsp://localhost:8080");
                        var uri1 = {
                          TAG: "LspURI",
                          _0: url1
                        };
                        var uri2 = {
                          TAG: "LspURI",
                          _0: url2
                        };
                        Curry._3(Assert.deepStrictEqual, Connection__URI$AgdaModeVscode.equal(uri1, uri2), true, undefined);
                      }));
                it("should return false for different LSP URIs", (function () {
                        var url1 = new Nodeurl.URL("lsp://localhost:8080");
                        var url2 = new Nodeurl.URL("lsp://localhost:9090");
                        var uri1 = {
                          TAG: "LspURI",
                          _0: url1
                        };
                        var uri2 = {
                          TAG: "LspURI",
                          _0: url2
                        };
                        Curry._3(Assert.deepStrictEqual, Connection__URI$AgdaModeVscode.equal(uri1, uri2), false, undefined);
                      }));
                it("should return false for mixed FileURI and LspURI", (function () {
                        var uri1 = {
                          TAG: "FileURI",
                          _0: Vscode.Uri.file("/usr/bin/agda")
                        };
                        var url = new Nodeurl.URL("lsp://localhost:8080");
                        var uri2 = {
                          TAG: "LspURI",
                          _0: url
                        };
                        Curry._3(Assert.deepStrictEqual, Connection__URI$AgdaModeVscode.equal(uri1, uri2), false, undefined);
                      }));
              }));
      }));

var URI;

exports.URI = URI;
/*  Not a pure module */
