// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Curry = require("rescript/lib/js/curry.js");
var Assert = require("assert");
var Util$AgdaModeVscode = require("../../src/Util/Util.bs.js");
var Test__Util$AgdaModeVscode = require("./Test__Util.bs.js");
var State__Command$AgdaModeVscode = require("../../src/State/State__Command.bs.js");
var State__Request$AgdaModeVscode = require("../../src/State/State__Request.bs.js");

function run(normalization) {
  describe("request to Agda", (function () {
          describe("global", (function () {
                  it("should be responded with the correct answer 1", (async function () {
                          var ctx = await Test__Util$AgdaModeVscode.AgdaMode.makeAndLoad(undefined, "Auto.agda");
                          var goal = ctx.state.goals[0];
                          var responses = goal !== undefined ? await State__Request$AgdaModeVscode.sendRequestAndCollectResponses(ctx.state, (function (extra) {
                                    return State__Command$AgdaModeVscode.dispatchCommand(ctx.state, extra);
                                  }), {
                                  TAG: "Auto",
                                  _0: normalization,
                                  _1: goal,
                                  [Symbol.for("name")]: "Auto"
                                }) : [];
                          var filteredResponses = responses.filter(Test__Util$AgdaModeVscode.filteredResponse);
                          var version = ctx.state.agdaVersion;
                          if (version !== undefined) {
                            if (Util$AgdaModeVscode.Version.gte(version, "2.7.0")) {
                              return Curry._3(Assert.deepEqual, filteredResponses, [
                                          {
                                            TAG: "GiveAction",
                                            _0: 0,
                                            _1: {
                                              TAG: "GiveString",
                                              _0: "n",
                                              [Symbol.for("name")]: "GiveString"
                                            },
                                            [Symbol.for("name")]: "GiveAction"
                                          },
                                          {
                                            TAG: "InteractionPoints",
                                            _0: [1],
                                            [Symbol.for("name")]: "InteractionPoints"
                                          }
                                        ], undefined);
                            } else {
                              return Curry._3(Assert.deepEqual, filteredResponses, [
                                          {
                                            TAG: "GiveAction",
                                            _0: 0,
                                            _1: {
                                              TAG: "GiveString",
                                              _0: "n",
                                              [Symbol.for("name")]: "GiveString"
                                            },
                                            [Symbol.for("name")]: "GiveAction"
                                          },
                                          {
                                            TAG: "DisplayInfo",
                                            _0: {
                                              TAG: "AllGoalsWarnings",
                                              _0: "*All Goals*",
                                              _1: "?1 : ℕ\n",
                                              [Symbol.for("name")]: "AllGoalsWarnings"
                                            },
                                            [Symbol.for("name")]: "DisplayInfo"
                                          },
                                          {
                                            TAG: "InteractionPoints",
                                            _0: [1],
                                            [Symbol.for("name")]: "InteractionPoints"
                                          }
                                        ], undefined);
                            }
                          } else {
                            Assert.fail("No Agda version found");
                            return ;
                          }
                        }));
                  it("should be responded with the correct answer 2", (async function () {
                          var ctx = await Test__Util$AgdaModeVscode.AgdaMode.makeAndLoad(undefined, "Auto.agda");
                          var goal = ctx.state.goals[1];
                          var responses = goal !== undefined ? await State__Request$AgdaModeVscode.sendRequestAndCollectResponses(ctx.state, (function (extra) {
                                    return State__Command$AgdaModeVscode.dispatchCommand(ctx.state, extra);
                                  }), {
                                  TAG: "Auto",
                                  _0: normalization,
                                  _1: goal,
                                  [Symbol.for("name")]: "Auto"
                                }) : [];
                          var filteredResponses = responses.filter(Test__Util$AgdaModeVscode.filteredResponse);
                          var version = ctx.state.agdaVersion;
                          if (version !== undefined) {
                            if (Util$AgdaModeVscode.Version.gte(version, "2.7.0")) {
                              return Curry._3(Assert.deepEqual, filteredResponses, [
                                          {
                                            TAG: "GiveAction",
                                            _0: 1,
                                            _1: {
                                              TAG: "GiveString",
                                              _0: "n",
                                              [Symbol.for("name")]: "GiveString"
                                            },
                                            [Symbol.for("name")]: "GiveAction"
                                          },
                                          {
                                            TAG: "InteractionPoints",
                                            _0: [0],
                                            [Symbol.for("name")]: "InteractionPoints"
                                          }
                                        ], undefined);
                            } else {
                              return Curry._3(Assert.deepEqual, filteredResponses, [
                                          {
                                            TAG: "GiveAction",
                                            _0: 1,
                                            _1: {
                                              TAG: "GiveString",
                                              _0: "m",
                                              [Symbol.for("name")]: "GiveString"
                                            },
                                            [Symbol.for("name")]: "GiveAction"
                                          },
                                          {
                                            TAG: "DisplayInfo",
                                            _0: {
                                              TAG: "AllGoalsWarnings",
                                              _0: "*All Goals*",
                                              _1: "?0 : ℕ\n",
                                              [Symbol.for("name")]: "AllGoalsWarnings"
                                            },
                                            [Symbol.for("name")]: "DisplayInfo"
                                          },
                                          {
                                            TAG: "InteractionPoints",
                                            _0: [0],
                                            [Symbol.for("name")]: "InteractionPoints"
                                          }
                                        ], undefined);
                            }
                          } else {
                            Assert.fail("No Agda version found");
                            return ;
                          }
                        }));
                }));
        }));
}

describe("agda-mode.auto", (function () {
        this.timeout(4000);
        describe("AsIs", (function () {
                run("AsIs");
              }));
        describe("Simplified", (function () {
                run("Simplified");
              }));
        describe("Normalised", (function () {
                run("Normalised");
              }));
        describe("HeadNormal", (function () {
                run("HeadNormal");
              }));
      }));

exports.run = run;
/*  Not a pure module */
