// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE
'use strict';

var Curry = require("bs-platform/lib/js/curry.js");
var $$Promise = require("reason-promise/lib/js/src/js/promise.js");
var Belt_Option = require("bs-platform/lib/js/belt_Option.js");
var Process$AgdaMode = require("agda-mode/lib/js/src/Process.bs.js");
var View$AgdaModeVscode = require("./View.bs.js");
var Caml_chrome_debugger = require("bs-platform/lib/js/caml_chrome_debugger.js");

function load(state) {
  console.log("load!");
  View$AgdaModeVscode.activate(state);
  return $$Promise.get(Process$AgdaMode.PathSearch.run("agda"), (function (param) {
                if (param.tag) {
                  var match = Curry._1(Process$AgdaMode.PathSearch.$$Error.toString, param[0]);
                  var body = match[1];
                  var header = match[0];
                  return Belt_Option.forEach(state.panel, (function (__x) {
                                return View$AgdaModeVscode.postMessage(__x, /* Display */Caml_chrome_debugger.simpleVariant("Display", [
                                              header,
                                              body
                                            ]));
                              }));
                } else {
                  var path = param[0];
                  return Belt_Option.forEach(state.panel, (function (__x) {
                                return View$AgdaModeVscode.postMessage(__x, /* Display */Caml_chrome_debugger.simpleVariant("Display", [
                                              "Path",
                                              path
                                            ]));
                              }));
                }
              }));
}

exports.load = load;
/* Promise Not a pure module */
