// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Vscode = require("vscode");
var Common$AgdaModeVscode = require("./View/Common.bs.js");
var Editor$AgdaModeVscode = require("./Editor.bs.js");
var Parser$AgdaModeVscode = require("./Parser/Parser.bs.js");
var SourceFile$AgdaModeVscode = require("./Parser/SourceFile.bs.js");

function generateDiffs($$document, indices) {
  var fileName = Parser$AgdaModeVscode.filepath($$document.fileName);
  var source = Editor$AgdaModeVscode.$$Text.getAll($$document);
  return SourceFile$AgdaModeVscode.parse(indices, fileName, source);
}

function getInnerRange(self, $$document) {
  var interval_0 = self.interval[0] + 2 | 0;
  var interval_1 = self.interval[1] - 2 | 0;
  var interval = [
    interval_0,
    interval_1
  ];
  return Common$AgdaModeVscode.Interval.toVSCodeRange($$document, interval);
}

function getOuterRange(self, $$document) {
  return Common$AgdaModeVscode.Interval.toVSCodeRange($$document, self.interval);
}

function getContent(self, $$document) {
  var innerRange = getInnerRange(self, $$document);
  return Editor$AgdaModeVscode.$$Text.get($$document, innerRange).trim();
}

function setContent(self, $$document, text) {
  var innerRange = getInnerRange(self, $$document);
  return Editor$AgdaModeVscode.$$Text.replace($$document, innerRange, " " + text + " ");
}

function setCursor(self, editor) {
  var $$document = editor.document;
  var match = self.interval;
  var position = $$document.positionAt(match[0] + 3 | 0);
  Editor$AgdaModeVscode.Cursor.set(editor, position);
  var range = Common$AgdaModeVscode.Interval.toVSCodeRange($$document, self.interval);
  editor.revealRange(range, undefined);
}

function refreshDecoration(self, editor) {
  var range = getOuterRange(self, editor.document);
  Editor$AgdaModeVscode.Decoration.decorate(editor, self.decorationBackground, [range]);
  var range$1 = new Vscode.Range(range.start, range.end.translate(0, -2));
  Editor$AgdaModeVscode.Decoration.decorate(editor, self.decorationIndex, [range$1]);
}

function destroyDecoration(self) {
  Editor$AgdaModeVscode.Decoration.destroy(self.decorationBackground);
  Editor$AgdaModeVscode.Decoration.destroy(self.decorationIndex);
}

var Module = {
  generateDiffs: generateDiffs,
  getContent: getContent,
  setContent: setContent,
  setCursor: setCursor,
  refreshDecoration: refreshDecoration,
  destroyDecoration: destroyDecoration
};

exports.Module = Module;
exports.generateDiffs = generateDiffs;
exports.getContent = getContent;
exports.setContent = setContent;
exports.setCursor = setCursor;
exports.refreshDecoration = refreshDecoration;
exports.destroyDecoration = destroyDecoration;
/* vscode Not a pure module */
