// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var React = require("react");
var Link$AgdaModeVscode = require("./Link.bs.js");
var Util$AgdaModeVscode = require("../../Util/Util.bs.js");
var Common$AgdaModeVscode = require("../Common.bs.js");
var RichText$AgdaModeVscode = require("./RichText.bs.js");
var Json_Decode$JsonCombinators = require("@glennsl/rescript-json-combinators/lib/js/src/Json_Decode.bs.js");
var Json_Encode$JsonCombinators = require("@glennsl/rescript-json-combinators/lib/js/src/Json_Encode.bs.js");

function plainText(s) {
  return {
          TAG: "Unlabeled",
          _0: RichText$AgdaModeVscode.string(s),
          _1: undefined,
          _2: undefined
        };
}

function error(s, raw) {
  return {
          TAG: "Labeled",
          _0: "Error",
          _1: "error",
          _2: s,
          _3: raw,
          _4: undefined
        };
}

function warning(s, raw) {
  return {
          TAG: "Labeled",
          _0: "Warning",
          _1: "warning",
          _2: s,
          _3: raw,
          _4: undefined
        };
}

function Item(props) {
  var item = props.item;
  var match = React.useState(function () {
        return false;
      });
  var setRevealRaw = match[1];
  var revealRaw = match[0];
  var onClickRevealRaw = function (param) {
    setRevealRaw(function (state) {
          return !state;
        });
  };
  var content = function (value, raw) {
    if (raw !== undefined && revealRaw) {
      return React.createElement(RichText$AgdaModeVscode.make, {
                  value: RichText$AgdaModeVscode.string(raw)
                });
    } else {
      return React.createElement(RichText$AgdaModeVscode.make, {
                  value: value
                });
    }
  };
  var revealRawButton = function (raw) {
    if (raw !== undefined) {
      if (revealRaw) {
        return React.createElement("div", {
                    className: "item-raw-button active",
                    onClick: onClickRevealRaw
                  }, React.createElement("div", {
                        className: "codicon codicon-code"
                      }));
      } else {
        return React.createElement("div", {
                    className: "item-raw-button",
                    onClick: onClickRevealRaw
                  }, React.createElement("div", {
                        className: "codicon codicon-code"
                      }));
      }
    } else {
      return React.createElement(React.Fragment, {});
    }
  };
  var locationButton = function ($$location) {
    if ($$location !== undefined) {
      return React.createElement(Link$AgdaModeVscode.make, {
                  target: {
                    TAG: "SrcLoc",
                    _0: $$location
                  },
                  jump: true,
                  hover: false,
                  className: ["item-location-button"],
                  children: React.createElement("div", {
                        className: "codicon codicon-link"
                      })
                });
    } else {
      return React.createElement(React.Fragment, {});
    }
  };
  switch (item.TAG) {
    case "Labeled" :
        var raw = item._3;
        return React.createElement("li", {
                    className: "labeled-item " + item._1
                  }, React.createElement("div", {
                        className: "item-label"
                      }, item._0), React.createElement("div", {
                        className: "item-content"
                      }, content(item._2, raw)), revealRawButton(raw));
    case "Unlabeled" :
        var raw$1 = item._1;
        return React.createElement("li", {
                    className: "unlabeled-item"
                  }, React.createElement("div", {
                        className: "item-content"
                      }, content(item._0, raw$1)), revealRawButton(raw$1), locationButton(item._2));
    case "Header" :
        return React.createElement("li", {
                    className: "header-item"
                  }, React.createElement("h3", undefined, item._0));
    
  }
}

var decode = Util$AgdaModeVscode.Decode.sum(function (x) {
      switch (x) {
        case "Header" :
            return {
                    TAG: "Payload",
                    _0: Json_Decode$JsonCombinators.map(Json_Decode$JsonCombinators.string, (function (s) {
                            return {
                                    TAG: "Header",
                                    _0: s
                                  };
                          }))
                  };
        case "Labeled" :
            return {
                    TAG: "Payload",
                    _0: Json_Decode$JsonCombinators.map(Util$AgdaModeVscode.Decode.tuple5(RichText$AgdaModeVscode.decode, Json_Decode$JsonCombinators.option(Json_Decode$JsonCombinators.string), Json_Decode$JsonCombinators.option(Common$AgdaModeVscode.AgdaRange.decode), Json_Decode$JsonCombinators.string, Json_Decode$JsonCombinators.string), (function (param) {
                            return {
                                    TAG: "Labeled",
                                    _0: param[3],
                                    _1: param[4],
                                    _2: param[0],
                                    _3: param[1],
                                    _4: param[2]
                                  };
                          }))
                  };
        case "Unlabeled" :
            return {
                    TAG: "Payload",
                    _0: Json_Decode$JsonCombinators.map(Json_Decode$JsonCombinators.tuple3(RichText$AgdaModeVscode.decode, Json_Decode$JsonCombinators.option(Json_Decode$JsonCombinators.string), Json_Decode$JsonCombinators.option(Common$AgdaModeVscode.AgdaRange.decode)), (function (param) {
                            return {
                                    TAG: "Unlabeled",
                                    _0: param[0],
                                    _1: param[1],
                                    _2: param[2]
                                  };
                          }))
                  };
        default:
          throw {
                RE_EXN_ID: Json_Decode$JsonCombinators.DecodeError,
                _1: "[Item] Unknown constructor: " + x,
                Error: new Error()
              };
      }
    });

var encode = Util$AgdaModeVscode.Encode.sum(function (x) {
      switch (x.TAG) {
        case "Labeled" :
            return {
                    TAG: "Payload",
                    _0: "Labeled",
                    _1: Util$AgdaModeVscode.Encode.tuple5(RichText$AgdaModeVscode.encode, Json_Encode$JsonCombinators.option(function (prim) {
                              return prim;
                            }), Json_Encode$JsonCombinators.option(Common$AgdaModeVscode.AgdaRange.encode), (function (prim) {
                            return prim;
                          }), (function (prim) {
                            return prim;
                          }), [
                          x._2,
                          x._3,
                          x._4,
                          x._0,
                          x._1
                        ])
                  };
        case "Unlabeled" :
            return {
                    TAG: "Payload",
                    _0: "Unlabeled",
                    _1: Json_Encode$JsonCombinators.tuple3(RichText$AgdaModeVscode.encode, Json_Encode$JsonCombinators.option(function (prim) {
                                return prim;
                              }), Json_Encode$JsonCombinators.option(Common$AgdaModeVscode.AgdaRange.encode))([
                          x._0,
                          x._1,
                          x._2
                        ])
                  };
        case "Header" :
            return {
                    TAG: "Payload",
                    _0: "Header",
                    _1: x._0
                  };
        
      }
    });

var make = Item;

exports.plainText = plainText;
exports.error = error;
exports.warning = warning;
exports.make = make;
exports.decode = decode;
exports.encode = encode;
/* decode Not a pure module */
